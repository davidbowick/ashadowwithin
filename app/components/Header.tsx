"use client";

import Image from "next/image";
import Link from "next/link";
import { usePathname } from "next/navigation";
import { useState, useEffect } from "react";
import styles from "./Header.module.css";
import { NAV_ITEMS } from "./navItems";
import MetalHamburger from "./MetalHamburger";

export default function Header() {
  const pathname = usePathname();
  const [menuOpen, setMenuOpen] = useState(false);
  const isHome = pathname === "/";

  return (
    <header
      className={[
        styles.header,
        isHome ? styles.headerHome : styles.headerDefault,
        menuOpen ? styles.menuOpen : "",
      ].join(" ")}
    >
      {/* Hidden SEO title */}
      <h1 className="visually-hidden">
        <Link href="/">A Shadow Within</Link>
      </h1>

      {/* Logo (always links home) */}
      <Link href="/" aria-label="A Shadow Within Home" className={styles.logo}>
        {isHome ? (

            <svg id="logo" xmlns="http://www.w3.org/2000/svg" width="246.96" height="197.76" viewBox="0 0 246.96 197.76"><path d="M59.94,138.31c.29.39.44,0,.48-.36.1-.74-.08-1.59.03-2.38.37-2.88,2.71-5.77,3.94-8.29,2.65-5.42,4.72-10.69,5.85-16.68l4.56-9.56c-2-.74-2.91-2.96-3.53-4.87-1.62-4.97-2.26-11.08-3.78-15.88-.8-2.53-2.7-4.85-3.59-7.2-.36-.94-.33-1.9-.84-2.76,1.13-.1,4.73-3.73,4.53-4.51-1.18-.65-1.57-2.12-2.49-2.8-.46-.34-.93-.37-1.3-.62-1.35-.89-4.59-10.08-5-12.02-.13-.62.04-1.29-.08-1.84-1.26-5.57-4.88-9.93-5.52-15.69-.96.01-1.49,0-2.38-.38-2.28-.97-6.47-5.28-8.52-5.62-.59-.1-1.22.05-1.84-.07-1.2-.24-2.23-1.79-3.21-2.54-3.03-2.32-7.29-3.26-9.91-6.03,2.1.83,4.41,1.74,6.65,2.09,1.68.27,3.49.11,5.2.55,2.63.68,4.22,1.42,7.14,1.97,2.66.5,2.9.57,5.22,1.74,2.94,1.48,4.52.4,7.3.85,1.34.21,3.74,1.61,5.06,1.68,2.13.11,4.43-1.07,6.69-.72.72.11,1.55.76,2.34,1.02,4.15,1.34,6.94,1.05,11.1,1.61.25.03,3.56.57,3,.95-1.68-.14-2.51,1.2-4.25,1.15l-8.55,4.87c-1.43,1.92,1.01,3.48,1.27,5.39.28,2.02-.97,4.23-.41,6.16.09.32.57.63.75,1.17,1.83,5.44,3.3,11.05,5.02,16.55.37,1.2,2.67,6.05,2.58,6.75-.02.17-.48.05-.52.5-.05.62.22,1.44.39,2.05l5.27-10.79c.54-1.25,1.8-2.5,2.33-3.67.49-1.09.43-2.42.95-3.37s3.23-2.64,3.29-2.94c-.04-.55-.52-.94-.63-1.46-.21-.95.71-4.7,1.07-5.77.29-.86.92-1.46,1.16-2.2.36-1.11.28-2.28.79-3.53.47-1.13,1.49-2.2,2.01-3.27,1.25-2.54.81-5.72,1.46-8.37.35-1.42,1.24-2.57,1.36-4.18.57-7.66,1.41-15.41,1.46-23.21l.47-1.8c.47,5.63,1.28,11.22,2.27,16.78.62,3.47,1.31,7.57,2.25,10.93.45,1.62,1.33,3.16,1.65,4.82.21,1.1.1,2.19.41,3.42s1.26,2.28,1.03,3.42c-.07.33-.39.63-.42,1.03-.09,1.19,2.68,5.31,3.32,6.73,2.33,5.19,2.8,11.13,5.03,16.31,1.05,2.44,2.82,4.77,3.92,7.1.65,1.38,1.18,3.36,1.86,4.85.11.24.14.56.49.59-.32-1.58.85-2.28,1.4-3.28,5.38-9.7,7.67-20.16,10.45-30.78.27-1.02.93-2.06,1.22-3.1,2.13-7.76,1.22-16.33,3.1-23.99.5-2.05.84-2.82,1.12-5.11.04-.29.11-1.31.45-1.35-.18,4.52.46,9.03,1.27,13.47.46,2.5,1.44,8.08,2.61,10.1,4.99,8.68,6.64,18.34,9.98,27.66,1.08,1.87,3.04,3.06,4.45,4.68.47,1.23-.29,2.3-.02,3.61.22,1.05,1.29,1.6,1.52,2.32s.03,1.59.21,2.42c.19.88.72,2.48,1.33,3.1.3-2.65,2.1-4.82,3.06-7.13.84-2.03,1.21-4.38,1.91-6.48.59-1.76,2.04-4.45,2.36-6.03.26-1.31-.09-2.69.16-3.91.16-.79.91-1.36,1.22-2.14.69-1.78.81-5.07,1.24-7.15s1.44-3.32.97-5.52c-.11-.53-.38-1.35-.98-1.44-1.26-.18-6.39,1.71-7.54,2.65l2.4-3.23c3.75-2.77,6.65-6.55,11.2-8.22,1.84-.68,5.08-1.09,6.71-1.92.77-.39,1.22-1.26,1.87-1.72,1.55-1.11,3.37-.88,5.16-1.32,1.44-.35,2.66-1.16,3.97-1.55,1.69-.5,3.63-.46,5.35-.89,3.06-.76,8.11-2.38,10.99-3.63,2.27-.99,4.44-2.74,7.03-3.16-1.9,1.61-3.5,3.67-5.4,5.26-2.19,1.84-4.89,3.07-7.07,4.92s-4.19,4.27-6.23,6.24c-.67.65-1.91,1.39-2.52,2.04-1.95,2.08-1.85,5.61-3.95,8.03-.86.99-2.99,1.57-4.19,2.52-3.6,2.83-8.76,12.62-10.79,17.02-.94,2.03-2.13,4.99-2.7,7.13-.64,2.45-.58,5.24-1.33,7.54-.51,1.55-1.75,3.16-2.44,4.75-1.68,3.84-2.3,7.31-3.06,11.32-.24,1.28-1.75,3.45-1.35,4.58l1.63.77c1.6,3.48,2.22,7.33,3.81,10.81,1.67,3.64,4.27,6.92,6,10.78,1.26,2.8,1.93,5.77,3.03,8.47.87,2.13,2.98,4.24,3.24,6.71.34-.03.38-.35.49-.59,5.09-11.13,7.22-23.64,12.06-34.93,1.2-4.61,2.28-9.3,3.63-13.87.31-1.04.99-1.46,1.22-2.14.32-.92.23-2.15.64-3.2.74-1.9,3.34-3.21,3.67-4.48s.04-2.8.47-4.33c.39-1.4,1.53-2.62,1.74-4.01.17-1.07-.03-2.16.12-3.24.18-1.28,1.05-2.2,1.27-3.28.17-.83,0-1.57.11-2.29,1.08-6.51,4.81-13.38,7.53-19.32.65-1.41,1.25-5.5,1.1-7.05-.16-1.72-1.51-2.99-1.44-4.67,3.27,2.81,7.68,1.91,11.63,1.68.87-.05,1.77.07,2.63,0,2.92-.26,6.11-1.37,9-.6.26.07,2.1.86,2.15.97-.61.24-1.19.53-1.75.88-2.34,1.43-4.6,2.39-7.11,3.44-5.11,2.14-8.92,9.36-10.49,14.45-1.15,3.73-1.44,8.74-2.9,12.21-.48,1.15-1.68,1.95-2.34,3.18-.78,1.46-1.09,3.24-1.75,4.73-1.65,3.73-5,8.51-5.73,12.25-.59,3.04-.91,5.9-1.86,8.92s-3.46,6.63-4.08,9.59c-.18.86.04,1.81-.16,2.47-.31,1.03-2.52.77-2.78,2.51s1.23,2.65,1.53,4.12c.43,2.08-1.71,4.02-2.5,5.92-1.09,2.63-3.24,6.4-3.94,8.76-.43,1.43-.43,3-.81,4.46-3.95,15.31-9.51,30.17-13.15,45.59-.88,3.74-1.01,7.93-1.56,11.75-.48-.09-.39-.51-.48-.84-2.01-7.69-3.61-15.4-5.11-23.18-1-5.2-2.04-12.58-4.36-17.22-1.68-3.37-2.55-6.5-4.16-9.75-.88-1.77-2.15-3.28-2.96-4.95-1.01-2.08-1.38-4.7-2.42-6.68-.49-.94-1.59-1.83-1.9-2.65-.22-.58-.01-1.37-.42-1.61-.28,2.4-1.54,4.58-2.09,6.9-.51,2.13-.53,5.04-1.14,7.01-.28.89-1.36,1.58-1.75,2.32-1.26,2.36-1.75,6.02-2.99,8.28-1.11,2.02-2.6,3.77-3.05,6.3-.74,4.22-1.84,9.78-3.14,13.88-1.1,3.46-2.36,5.62-2.4,9.6-.06,6.43-1.2,12.1-1.66,18.45l-1.43,10.19c.03-.78-.23-1.48-.25-2.26-.22-7.57.37-15.25-1.55-22.67-.89-3.46-1.95-6.12-3.41-9.3-1.67-3.64-1.49-6.35-2.39-9.84-.29-1.13-1.56-2.71-2.04-3.96-1.32-3.43-.38-5.31-.68-8.67-.45-5.03-3.67-9.06-5.88-13.3-3.04-5.86-5.92-11.81-8.01-18.08l-.62-.14c-1.65,3.86-3.38,7.75-4.86,11.69-.81,2.16-1.17,4.38-2.11,6.52-1.37,3.16-1.55,2.63-2.06,6.33-.39,2.87-1.21,1.62-2.71,2.57s.69,2.34.81,3.44c-3.09,1.59-2.58,5.87-3.32,8.91-.92,3.8-3.15,7.4-3.76,11.34-.25,1.6-.11,3.13-.46,4.82-.94,4.53-3.62,9.34-3.6,14.38l-1.32,4.55v-5.87c0-1.64-1.75-5.01-2.1-7.01-.43-2.46-.26-5.05-.58-7.58-.81-6.56-3.85-11.97-5.79-18.18-.8-2.56-.92-5.11-2.19-7.64-.34-.67-.98-1.14-1.26-1.86-.47-1.22-.11-2.35-.42-3.41-.53-1.81-3.33-4.93-4.14-6.65-.31-.65-2.01-4.43-2.11-4.84-.29-1.16-.09-2.23-.53-3.55-.08-.23.04-.72-.42-.53-1.53.65-2.41,6.22-2.99,7.8-.92,2.52-2.58,4.41-4.08,6.46-1.01,1.37-.82,3.26-1.33,4.91-.66,2.12-2.12,4.3-2.82,6.53-1.04,3.33-1.49,7.11-2.51,10.44-.64,2.09-1.86,3.78-2.64,5.75-1.91,4.8-2.72,10.33-4.11,15.31l-.27,9.2-.53-.55c-1.31-6.56-1.98-13.3-3.42-19.83-.46-2.1-1.95-4.39-2.22-6.17-.22-1.41.18-3.16-.11-4.45-.21-.95-1.2-1.15-1.73-1.86-.35-.47-3.11-8.92-3.37-10.05-.76-3.27-1.3-6.36-2.4-9.59-1.24-3.66-3.19-7.58-4.26-11.32-.5-1.75-.59-3.73-1.26-5.45-.72-1.85-2.34-3.34-2.25-5.62.03-.7.55-1.27.36-2.06-.25-1.01-2.21-3.15-2.82-4.39-2.27-4.64-3.13-8.74-4.29-13.69-.13-.54-.61-1.12-.65-1.49-.05-.53.67-2.17.68-3.08.02-1.35-1.23-5.02-1.82-6.35-1.06-2.42-1.08-1.33-1.58-4.42-.68-4.28-2.6-7.46-3.51-11.6-.49-2.23.29-2.98.18-4.97-.22-3.9-2.71-4.48-4.21-7.3-1.68-3.16-2.15-7.12-3.98-10.4-.56-1-1.31-1.4-1.85-2.23-.89-1.35-1.74-3.7-2.57-4.87-.23-.32-2.82-2-3.39-2.36-1.45-.92-3.03-1.81-4.63-2.45-.04-.46.48-.19.72-.12.53.14.99.43,1.62.54,5.89,1.01,11.76,2.18,17.67,2.71,2.86.26,4.97-1.39,7.56-2.06.94-.24,1.98-.17,2.88-.59l.29,7.98c1.92,3.69,3.55,7.11,4.02,11.32.65,5.85,1.77,11.65,3.24,17.38.59,2.29,1.72,5,3.44,6.63-.82,1.98-3.56,3.62-2.79,6.15.32,1.05,5.79,1.86,5.68,3.64-.04.59-.75,1.27-.42,2,1.2.43,2.67,1.18,3.2,2.43.44,1.04.2,2.01.42,2.94,1.25,5.3,3.16,10.45,4.38,15.76,1.52,6.59,1.96,13.33,3.94,19.79.49,1.58,4.09,10.2,4.09,10.78v4.2ZM109.1,80.3c-.58-2.43-.4-4.7-1.14-7.13-1.38-4.59-4.84-8.42-4.14-13.36l-.71-5.39c.02,1.48-.91,2.71-1.33,4.06-1.92,6.12-1.69,5.93-5.48,11.06-2.14,2.89-2.72,5.61-4.33,8.61-.89,1.67-2.09,3.2-2.93,4.98-1.32,2.79-1.25,4.65-3.82,6.73-.55.45-1.91.53-.98,1.05.62.34,1.78.53,2.32,1.03.35.33.41.85.72,1.19.74.81,1.78.68,2.75.38l.34.37c.38,1.94.25,4.24.58,6.14.15.88.73,1.78.97,2.63,2.29,8.09,4.09,16.33,6.95,24.22l2.46,9.05,1.5-3.05,3.52-11.1c.43-.61,2.34.43,2.05-1.29-.06-.37-.41-.63-.47-.99-.22-1.26.72-1.42,1.24-2.33,1.25-2.16,1.97-5.3,2.95-7.59,1.42-3.31,3.44-6.68,5.33-9.74-.2-1.1-.61-2.17-1.02-3.2-.7-1.76-2.03-3.82-2.63-5.52-.34-.98-.29-2.01-.65-2.94-.27-.68-.89-1.01-.93-1.72-.08-1.33,1.24-3.28,1.71-4.55.34-.91.42-1.92.76-2.83.51-1.34,1.52-2.18,1.86-3.53-1.26,1.82-3.17,2.03-4.96,3.07-.38.22-2.31,1.84-2.47,1.72ZM152.74,86.3c.63-1.86-.39-2.15-.9-3.3-.39-.88-.16-1.89-.41-2.71-.22-.73-1.35-1.4-1.81-2.02-1.36-1.86-2.04-5.61-2.77-7.78-1.17-3.52-3.58-7.66-4.92-11.38-.16-.43-.25-.87-.23-1.33-.35.03-.37.35-.48.59-.75,1.62-.76,3.69-1.55,5.4s-1.91,3.52-2.64,5.28-.29,3.13-2.26,3.98c1.07,1.73.02,2.46-1.02,3.76-1.01,3.54-3.42,6.46-5.21,9.64,0,1.2,2.44,4.08,2.75,5.14.53,1.79.52,3.08,1.5,4.97.25.48.85.82.96,1.2.07.24.29,3.12.29,3.55,0,.93-.76,1.39-.31,2.45.56,1.29,2.92,1.31,4.14,1.26.41.37-1.79,1.9-2.02,2.17-.45.52-.68,1.31-1.09,1.79-.56.65-1.53.95-1.92,1.79,1.99-.18,3.9.3,5.78.87.31.72.14,1.52.32,2.27,1.23,5.18,3.14,9.41,5.52,14.13.65,1.28,1.86,2.61,2.33,3.9.63,1.72.98,4.1,1.39,5.92l.83-5.03c.77-3.75,3.52-8.61,4.09-12.21.2-1.29-.01-2.49.11-3.72.24-2.37,1.82-3.84,2.84-5.79.57-1.08.86-2.3,1.43-3.37,1.19-2.23,2.82-2.41,1.85-5.35-.21-.63-.82-1.16-.98-1.66-.65-2.07-1-5.15-1.9-7.21-.49-1.13-1.48-.4-.32-2.47l4.99-7.11c-.2-.16-3.35,1.25-4.01,1.38-.74.14-1.45,0-2.23.16-.83.17-1.31.86-2.14.85Z"/></svg>

        ) : (
          <Image
            src="/a-shadow-within-logo-white.png"
            alt="A Shadow Within logo"
            width={200}
            height={60}
            priority
          />
        )}
      </Link>

      {/* Desktop nav (only shows off-homepage) */}
      
        <nav className={styles.navDesktop} suppressHydrationWarning>
          {NAV_ITEMS.map((item) => {
            const isActive = pathname === item.href;
            return (
              <Link
                key={item.href}
                href={item.href}
                aria-current={isActive ? "page" : undefined}
                className={isActive ? styles.activeLink : ""}
              >
                {item.label}
              </Link>
            );
          })}
        </nav>
      

      {/* Mobile menu button */}
      <MetalHamburger
        isOpen={menuOpen}
        onToggle={() => setMenuOpen(!menuOpen)}
      />
      

      {/* Overlay menu */}
      {menuOpen && (
        <div className={styles.overlay}>
          <nav className={styles.menuContent} suppressHydrationWarning>
            {NAV_ITEMS.map((item) => {
              const isActive = pathname === item.href;
              return (
                <Link
                  key={item.href}
                  href={item.href}
                  onClick={() => setMenuOpen(false)}
                  className={isActive ? styles.activeLink : ""}
                >
                  {item.label}
                </Link>
              );
            })}
          </nav>
        </div>
      )}
    </header>
  );
}